tinymce.PluginManager.requireLangPack("characterscount");tinymce.PluginManager.add("characterscount",(function(editor,pluginUrl){var ed=editor,_=tinymce.util.Tools.resolve("tinymce.util.Delay");function getSettBool(name,defV){var v=ed.settings[name];return void 0===v||null===v?defV:"boolean"===typeof v?v:"string"===typeof v?"true"===v.toLowerCase():!!v}function getSettStr(name,defV){var v=ed.settings[name];return void 0===v||null===v?defV:v}function getSettNumb(name,defV){var v=ed.settings[name];if(0===v)return 0;var n=Number(v);return isFinite(n)&&n>=0?n:defV}var bTxt=getSettBool("characterscount_show_text",true),bSrc=getSettBool("characterscount_show_source",true),dl=getSettNumb("characterscount_debounce",250);function bSth(){return bTxt||bSrc}function normEol(s){return(s||"").replace(/\r\n/g,"\n")}function normPubTxt(s){return normEol(s).replace(/\u00A0/g," ")}function getCntTxt(){var text;return normPubTxt(ed.getContent({format:"text"})).length}function getCntSrc(){var html;return normEol(ed.getContent({format:"html"})).length}function cntTxt(){if(statusbar){var v="",sf=ed.translate("characterscount.label.text.suffix"),sfx=sf?" "+sf:"";if(bSth()){bTxt&&(v=ed.translate("characterscount.label.text.prefix")+" ≈ "+getCntTxt()+sfx);return v}}}function cntSrc(){if(statusbar){var v="",sf=ed.translate("characterscount.label.source.suffix"),sfx=sf?" "+sf:"";if(bSth()){bSrc&&(v=ed.translate("characterscount.label.source.prefix")+" ≈ "+getCntSrc()+sfx);return v}}}function upd(){bTxt&&ed.theme.panel.find("#characterscount-text").text(cntTxt());bSrc&&ed.theme.panel.find("#characterscount-source").text(cntSrc())}ed.on("preinit",(function(){var csslink=editor.dom.create("link",{rel:"stylesheet",href:pluginUrl+"/css/ui.css"});document.getElementsByTagName("head")[0].appendChild(csslink)}));ed.on("init",(function(){var stBar=ed.theme&&ed.theme.panel&&ed.theme.panel.find?ed.theme.panel.find("#statusbar")[0]:null,n=_.debounce(upd,dl);if(stBar){_.setEditorTimeout(ed,(function(){bTxt&&stBar.insert({type:"label",name:"characterscount-text",text:cntTxt(),classes:"characterscount",disabled:ed.settings.readonly},0);bSrc&&stBar.insert({type:"label",name:"characterscount-source",text:cntSrc(),classes:"characterscount",disabled:ed.settings.readonly},0);ed.on("setcontent beforeaddundo undo redo keyup change paste",n)}),0);n()}}));return{getCounts:function(){return{text:getCntTxt(),source:getCntSrc()}}}}));